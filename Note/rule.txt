# DEVELOPMENT RULES & GUIDELINES

## ğŸ—ï¸ ARCHITECTURE RULES

### Composables Structure (/src/composables/)
- **useAuth.js**: All authentication logic (login, signup, logout, social auth)
- **useStorage.js**: localStorage operations (remember me, data persistence)
- **useLanguage.js**: Global language state, translations, text management
- **useErrorHandler.js**: Centralized error handling with consistent messages

### Component Rules
- Use Composition API with setup()
- Import composables, not direct Firebase/localStorage
- Watch props for language sync: `watch(() => props.currentLanguage, syncWithProp, { immediate: true })`
- Return all template-used variables/methods from setup()

## ğŸ”„ STATE MANAGEMENT

### Language System
- Global state in useLanguage: `const globalLanguage = ref('vi')`
- All components sync with global state via `syncWithProp()`
- Parent components use `toggleLanguage()` to change language
- Text via `getText(key)` - never hardcode strings

### Auth State
- Single auth listener in useAuth composable
- User state shared across all components
- Auto-cleanup on component unmount

## ğŸ¯ CODE STANDARDS

### NO Ternary Operators
```javascript
// âŒ Bad
const text = isVi ? 'ÄÄƒng nháº­p' : 'Login'

// âœ… Good
let text
if (isVi) {
  text = 'ÄÄƒng nháº­p'
} else {
  text = 'Login'
}
```

### Error Handling
- Always use `showError(error, context)` from useErrorHandler
- Never direct alert() - use composable methods
- Context types: 'login', 'signup', 'google', 'facebook', 'reset', 'logout'

### File Comments
```javascript
/*
Component purpose and main logic
- Feature 1: Description
- Feature 2: Description
*/
```

## ğŸ“ FILE STRUCTURE

```
src/
â”œâ”€â”€ composables/          # Reusable logic
â”œâ”€â”€ components/          # UI components
â”œâ”€â”€ view/               # Page views
â”œâ”€â”€ firebase/           # Firebase config
â””â”€â”€ router/            # Vue Router
```

## ğŸš« FORBIDDEN PRACTICES

- âŒ Direct Firebase imports in components
- âŒ Direct localStorage usage in components  
- âŒ Duplicate auth state management
- âŒ Hardcoded text strings
- âŒ Ternary operators for complex logic
- âŒ Multiple onAuthStateChanged listeners
- âŒ Props mutation

## âœ… REQUIRED PRACTICES

- âœ… Use composables for all logic
- âœ… Watch props for reactivity
- âœ… Global language state
- âœ… Consistent error handling
- âœ… Clean component separation
- âœ… Return setup() values
- âœ… Immediate watch for props

## ğŸ”§ DEBUGGING CHECKLIST

1. **Language not working**: Check if component watches props and calls syncWithProp
2. **Auth issues**: Verify useAuth composable import and user state binding
3. **Errors not showing**: Ensure useErrorHandler is imported and used
4. **State not syncing**: Check global state usage in composables
5. **Components breaking**: Verify all template variables returned from setup()

## ğŸ“ COMMIT STANDARDS

- feat: new functionality
- fix: bug fixes  
- refactor: code restructuring
- style: UI/CSS changes
- docs: documentation updates